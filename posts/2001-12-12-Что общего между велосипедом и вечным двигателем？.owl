---
title: 'Что общего между велосипедом и вечным двигателем?'
permalink: /post/show/976
date: '2001-12-12 12:57:11'
categories: [txt]
---

§3 Размножение сущностей

Как все недоучки, я учился программировать непосредственно на первомзаказе. Не могу с уверенностью сказать, что я чему-то научился; тем не менеепуть наименьшего сопротивления прельстил меня полностью. Разумеется, я выбрал≈Borland Delphi≈ в качестве инструмента разработки. Алгоритмизацией ябаловался с пятого класса средней школы, алгоритм Эвклида на фортране былнаписан и даже — успешно отлажен на ≈EC-1080≈. Если я ничего непутаю. Перфокарты с итоговым вариантом я бережно храню до сих пор. Впрочем, яотвлекся.

Пугало меня создание пользовательского интерфейса. Формочки, кнопочки, менюшки, тулбарчики. Я совершенно не представлял себе, с какойстороны можно ко всему этому подойти. Поэтому я выбрал — ≈Delphi≈.Втуне надеясь, что грамотный ≈RAD≈ решит за меня все проблемы, связанныес созданием окошечек и прочих мулечек. Это была, если не ошибаюсь, втораяверсия.

Достаточно быстро справившись с алгоритмизацией, я занялся проектированиеминтерфейса. Потырил нехитрым способом (≈Alt+PrintScreen≈) иконки из какого-то ≈Microsoft≈'овского монстра и открыл редактор форм. Я собирался следовать рекомендациям профессионалов, поэтому потратил некоторое время на тщательное дублирование пунктов меню — кнопками в тулбаре. Многие помнят, как впервых версиях ≈Delphi≈ был реализован интерфейс добавления событий.Выбираешь кнопочку, либо пункт меню, щелкаешь по ней дважды — и кусочек кодаобработчика события нажатия кнопки готов. По неопытности (ну да, вообще-то — поглупости) я старался вносить минимальные исправления в сгенерированный код.Одним из наиболее свежих моих воспоминаний на тот момент была попытка реанимацииредактора форм в ≈MS Visual Studio≈ после ручной правки нагенерированногомастером шаблонов мусора. И я старательно эксплуатировал великую технологию ✿_span_fixedfontCut&Paste✿_span_fixedfont  — написав код обработчика нажатия кнопки, я копировалего в обработчик соответствующего пункта меню. Я надеюсь, не нужно объяснять,чем чреват такой подход.

Я, очевидно, был не единственный в когорте недоумков, плодивших сущноститакого толка. Иначе сложно объяснить появление эзотерических объектов типа ✿_span_fixedfontTAction✿_span_fixedfont  в последующих версиях ≈Delphi≈. Разработчики ввелилишнюю, по сути, сущность — намеренно создав узкое место для нерадивых программистов. Допустить ошибку рассинхронизации кода обработки кнопок и менюстало гораздо сложнее.

§3 Один на один!

Вообще говоря, тема корректного позиционирования событий относительно осидействий пользователя — очень больной вопрос для многих программистов. Самый,пожалуй, яркий пример здесь — элемент управления типа ≈CheckBox≈,отражающий состояния бинарного типа (да/нет). Я сделал десятки глупейших ошибокв коде, заводя дополнительную переменную для хранения самого значения. Ведьконтент должен быть отделен от оформления, не так ли? Так, да не совсем.Стандартными средствами языков ≈Pascal≈ и ≈C++≈, к великомусожалению, не обеспечить безопасное разделение. Заведите переменную, отдельно отфлажка на форме — и через неделю показания флажка и значения переменнойрассинхронизуются в какой-нибудь экзотической ситуации.

≈Хорошая новость:≈ средствами ≈Java≈ — обеспечить механизм разделения можно. Я часто говорю, что одним из основных преимуществ этого языка я считаю модель ≈Listener≈'ов. Все до безобразия просто — нажатие мышкой на флажок напрямую меняет значение внутренней переменной; сам флажок — регистрируется «слушателем» и получает извещения обо всех изменениях, происходящих с переменной, будь то скрытая установка значения из кода, чтение из файла, или даже щелчок по другому связанному с переменной флажку в соседнем окне.

Сплошное торжество здравого смысла — теперь у нас есть одна переменная,сколько угодно ее визуальных представлений; вдобавок мы практически застрахованыот рассинхронизации. Можно провозгласить какой-нибудь лозунг и со спокойной совестью отправиться на обед.

§4 Сущность описывающая живущий во времени объект —  ⏎
 это ≈Persistent≈-класс, подключающий ≈Listener≈'ы. ⏎
 Сущность описывающая моментальное действие —  ⏎
 это ≈Listener≈-класс, как правило — имеющий визуализатор.

Разумеется, оба класса должны уметь каскадно встраиваться друг в друга(объекты обоих типов могут содержать объекты первого типа в соотношении≈«one-to-many»≈, при этом первый тип должен уметь вызыватьсоответствующие ≈Listener≈'ы на сыновьях, а второй — при случае корректноотрисовать не только себя, но и всех дочерей).

§3 Великие изобретатели.

Именно из вышеизложенных соображений я всегда предпочитаю воспользоватьсятретьесторонней библиотекой, а не писать свою. При условии, что мне знакомо имяпроизводителя этой библиотеки, проект развивается и есть возможностьего протестировать. Даже, если эта библиотека не охватывает всех моих нужд. Причина проста: я буду выступать ≈Listener≈'ом у той компании, я будупросто немного адаптировать свой код в соответствии с развитием библиотеки. Еслисейчас кажется, что переписать эту хрень — дело двух рабочих дней, то завтраситуация неизбежно изменится. И я столкнусь с необходимостью поддерживать своюпрограмму и ≈библиотеку≈. Помните, раньше каждый считал своим долгомнаписать собственную программу инсталляции? Тех, кто поддался этому соблазну и не пошел «на поводу» у славных ребят из ≈Wise≈ и/или ≈InstallShield≈ — с выходом каждой очередной версии ≈Windows≈ — ждут бессонные ночи ирасшатанные нервы.

Поэтому я, скрепя сердце, пользуюсь стандартными элементами управления,стандартными средствами визуализации, стандартной формой окон и стандартноймаркой сигарет. По крайней мере, при таком раскладе мне не придется рвать наголове волосы, когда разработчики ≈Longhorn≈'а скажут: «с сегодняшнегодня все окна нужно делать круглыми».

✿_p_obsolete NB! Следующий абзац на данный момент устарел :-( Последний пример, который мне хочется привести — касается поиска по сайту.Я его недавно прикручивал. И понял вот что: не нужно поддаваться соблазну и,например, парсить ответ Google, чтобы показать результаты в том же стиле, вкотором оформлен сайт. Я не хочу оказаться у разбитого корыта, и даже не узнатьоб этом (а я — ага,— достаточно редко хожу к себе на сайт), когда разработчики этойпрекрасной во всех отношениях поисковой машины по ту сторону океана решатоснастить страницу дополнительным тегом. Кроме того, я не хочу скрывать, чтопоиск по моему сайту за меня выполняет Google. Я им признателен и вообще.Поэтому я сделал вот как:

λform name="googlesearch" method="get" ⏎
 action="http://www.google.com/search" ⏎
 onSubmit="if (q.value == '') return false; ⏎
 q.value = q.value + ' site:www.matiouchkine.de'; ⏎
  return true;λ

Потратив на это две минуты и будучи абсолютно уверенным, что меня не ждутнеприятные неожиданности в будущем.

И да, я знаю про  Google APIs¹http://www.google.com/apis/ . Только вот нужна ли мне эта пушка для стрельбы поредкозалетающим воробьям? Мне кажется, нет.

А сэкономленное таким нехитрым способом время я потратил на написание этойстатейки.

Все стремятся изобрести велосипед и вечный двигатель.